<!doctype html>
<html>
<head>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta charset="utf-8" />
  <title>EXACT Portal</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#fbfbfc;
      --card:#fff;
      --text:#0b0b0c;
      --muted:#6b6f76;
      --line:rgba(15,20,25,.10);
      --shadow:0 12px 30px rgba(15,20,25,.08);
      --radius:14px;
      --gold:#b89a5b;
      --danger:#b42318;
    }

    *{box-sizing:border-box}

    body{
      margin:0;
      font-family:Montserrat,system-ui,sans-serif;
      background:var(--bg);
      color:var(--text);
    }

    .container{
      max-width:1100px;
      margin:28px auto;
      padding:0 18px 60px;
    }

    .card{
      background:var(--card);
      border:1px solid var(--line);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:16px;
      margin:14px 0;
    }

    button{
      border:1px solid var(--line);
      background:#fff;
      padding:9px 12px;
      border-radius:12px;
      font-weight:600;
      cursor:pointer;
    }

    .btn-primary{
      background:var(--text);
      color:#fff;
      border:none;
    }

    .btn-success{
      background:#1f9d55;
      color:#fff;
      border:none;
    }

    .subtle{
      color:var(--muted);
      font-size:12px;
    }

    /* ============================
       âœ… SPINNER (GLOBAL FIX)
       ============================ */
    .spinner{
      width:14px;
      height:14px;
      border:2px solid rgba(255,255,255,.35);
      border-top-color:#fff;
      border-radius:50%;
      display:inline-block;
      vertical-align:middle;
      animation:spin .7s linear infinite;
    }

    @keyframes spin{
      to{transform:rotate(360deg)}
    }
  </style>
</head>

<body>
<div class="container">

  <!-- TOP BAR -->
  <div id="topBar" class="card" style="display:none;">
    <strong>EXACT Portal</strong>
    <button id="logoutBtn" style="float:right">Logout</button>
  </div>

  <!-- LOGIN -->
  <div id="loginBox" class="card" style="max-width:480px;">
    <h2>Login</h2>
    <input id="email" placeholder="Email"><br><br>
    <input id="password" type="password" placeholder="Password"><br><br>
    <button id="loginBtn" class="btn-primary">Login</button>
    <p id="authMsg" class="subtle"></p>
  </div>

  <!-- APP -->
  <div id="appBox" style="display:none;">

    <!-- ORDERS -->
    <div id="viewOrders" class="card">

      <div style="display:flex;justify-content:space-between;align-items:center">
        <h2>Orders</h2>
        <button id="ordersCreateBtn" class="btn-success">Create Order</button>
      </div>

      <div id="ordersMsg" class="subtle"></div>

      <div id="ordersListPanel">
        <div id="ordersList"></div>
      </div>

      <div id="ordersDetailPanel" style="display:none;margin-top:14px;">
        <div style="display:flex;justify-content:space-between;align-items:center;">
          <div>
            <div id="ordersDetailTitle" style="font-weight:800"></div>
            <div id="ordersDetailMeta" class="subtle"></div>
          </div>

          <div style="display:flex;gap:10px;">
            <button id="ordersBackBtn">Back</button>
            <button id="ordersRefreshBtn">Refresh</button>
            <button id="ordersMarkPaidBtn" class="btn-primary">Mark Paid</button>
            <button id="ordersCompBtn">Comp</button>
            <button id="ordersGeneratePackBtn" class="btn-primary">
              Generate Pack
            </button>
          </div>
        </div>

        <!-- PAYMENT -->
        <div id="ordersPayPanel" style="margin-top:14px;display:none;">
          <h3>Payment</h3>
          <div id="ordersPayMsg" class="subtle"></div>
          <button id="ordersPayBtn" class="btn-success">Pay now</button>
          <button id="ordersPayCancelBtn">Cancel</button>
          <div id="stripePaymentEl" class="card" style="display:none;margin-top:12px;"></div>
        </div>

        <h3>Batch / process summary</h3>
        <div id="ordersBatchSummary"></div>

        <h3>Artifacts</h3>
        <div id="ordersArtifactsList"></div>
      </div>

    </div>
  </div>
</div>

<!-- SCRIPTS -->
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
<script src="https://js.stripe.com/v3/"></script>
<script type="module" src="./app_v41.js?v=42"></script>

</body>
</html>
